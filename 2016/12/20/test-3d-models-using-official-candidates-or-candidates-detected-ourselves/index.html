<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="#!/usr/local/bin/python# -- coding: utf-8 --‘’’This function calculates if the axis is a nodule using 3D model.   the output is the posibility of an axis whether it is a nodule.    Author: Kong Haiyan">
<meta property="og:type" content="article">
<meta property="og:title" content="Test 3D models using official candidates or candidates detected ourselves">
<meta property="og:url" content="http://yoursite.com/2016/12/20/test-3d-models-using-official-candidates-or-candidates-detected-ourselves/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="#!/usr/local/bin/python# -- coding: utf-8 --‘’’This function calculates if the axis is a nodule using 3D model.   the output is the posibility of an axis whether it is a nodule.    Author: Kong Haiyan">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-07-27T03:00:21.875Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Test 3D models using official candidates or candidates detected ourselves">
<meta name="twitter:description" content="#!/usr/local/bin/python# -- coding: utf-8 --‘’’This function calculates if the axis is a nodule using 3D model.   the output is the posibility of an axis whether it is a nodule.    Author: Kong Haiyan">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2016/12/20/test-3d-models-using-official-candidates-or-candidates-detected-ourselves/"/>





  <title>Test 3D models using official candidates or candidates detected ourselves | Hexo</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/20/test-3d-models-using-official-candidates-or-candidates-detected-ourselves/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Test 3D models using official candidates or candidates detected ourselves</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-20T21:02:13+08:00">
                2016-12-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/谈天说地/" itemprop="url" rel="index">
                    <span itemprop="name">谈天说地</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>#!/usr/local/bin/python<br># -<em>- coding: utf-8 -</em>-<br>‘’’This function calculates if the axis is a nodule using 3D model.<br>   the output is the posibility of an axis whether it is a nodule.</p>
<p>   Author: Kong Haiyang<br>‘’’<br>from __future__ import absolute_import<br>from __future__ import division<br>from __future__ import print_function<br>import SimpleITK as sitk</p>
<p>import os<br>import sys<br>from os import walk<br>import numpy as np<br>import csv<br>import time<br>import cv2<br>from scipy.ndimage.interpolation import zoom</p>
<p>from six.moves import urllib<br>from six.moves import xrange<br>import tensorflow as tf</p>
<p>FLAGS = tf.app.flags.FLAGS<br>tf.app.flags.DEFINE_integer(‘IMAGE_SIZE’, 40, “Size of input Image.”)<br>tf.app.flags.DEFINE_integer(‘PIXEL_DATA_SIZE’, 4, “Size of Image pixel.”)<br>tf.app.flags.DEFINE_integer(‘CHANNEL_NUMBER’, 1, “Channels of input Image.”)<br>tf.app.flags.DEFINE_integer(‘LABEL_NUMBER’, 2, “Label number.”)<br>tf.app.flags.DEFINE_integer(‘BATCH_SIZE’, 128, “Size of a Batch.”)<br>tf.app.flags.DEFINE_integer(‘NUM_EPOCHS’, 4, “Number of epochs.”)<br>tf.app.flags.DEFINE_integer(‘EVAL_BATCH_SIZE’, 128, “Size of an Evalution Batch.”)<br>tf.app.flags.DEFINE_integer(‘SEED’, 66478, “Seed of Shuffle.”)<br>tf.app.flags.DEFINE_string(‘TOWER_NAME’, ‘JP’, “Name of tower.”)<br>tf.app.flags.DEFINE_integer(‘NUM_GPU’, 1, “How many GPUs to use.”)<br>tf.app.flags.DEFINE_integer(‘NUM_PREPROCESS_THREADS’, 12,<br>                            “Number of preprocessing threads.”)<br>tf.app.flags.DEFINE_integer(‘NUM_LABEL’, 1, “How many Label bytes in a unit of Bin file.”)<br>tf.app.flags.DEFINE_integer(<br>    ‘NUM_IMAGE’, 40 ** 3, “How many Image bytes in a unit of Bin file.”)<br>tf.app.flags.DEFINE_integer(‘PIXEL_LENGTH’, 4, “Length of label or image pixel.”)<br>tf.app.flags.DEFINE_string(<br>    ‘CSV_FILE’, ‘/home/kong/4T/official3D_110W/Shuffle.csv’, “Csv file path and name.”)<br>tf.app.flags.DEFINE_string(<br>    ‘BIN_FILE’, ‘/home/kong/4T/official3D_110W/shuffle3D64.bin’, “Bin file path and name.”)<br>tf.app.flags.DEFINE_bool(‘SAVE_MODEL’, True, ‘Save model or not.’)<br>tf.app.flags.DEFINE_bool(‘USE_OFFICIAL’, True, ‘Use official csv or not.’)<br>tf.app.flags.DEFINE_integer(‘CUT_SIZE’, 64, ‘Size of block cutting out.’)<br>tf.app.flags.DEFINE_integer(‘SAVE_SIZE’, 40, ‘Size of block saved.’)</p>
<p>XAVIER_INIT = tf.contrib.layers.xavier_initializer(seed=FLAGS.SEED)</p>
<p>def normalizePlanes(npzarray):<br>  maxHU = 400.<br>  minHU = -1000.<br>  npzarray = (npzarray - minHU) / (maxHU - minHU)<br>  npzarray[npzarray &gt; 1] = 1.<br>  npzarray[npzarray &lt; 0] = 0.<br>  return npzarray</p>
<p>def saveImageSlice(image, cc, path):<br>  if not os.path.exists(path):<br>    os.makedirs(path)<br>  imageTemp = image[cc[0] - 32:cc[0] + 32, …]<br>  for index in np.arange(imageTemp.shape[0]):<br>    sliceTemp = imageTemp[index, :, :].copy()<br>    cv2.rectangle(sliceTemp, (cc[2] - 32, cc[1] - 32),<br>                  (cc[2] + 32, cc[1] + 32), (255, 255, 255))<br>    cv2.imwrite(path + str(index) + ‘.png’, sliceTemp * 255)</p>
<p>def worldToVoxelCoord(worldCoord, origin, outputSpacing):<br>  stretchedVoxelCoord = np.absolute(worldCoord - origin)<br>  voxelCoord = stretchedVoxelCoord / outputSpacing<br>  return voxelCoord</p>
<p>def interpolatefilter(inputpath):<br>  inputimage = sitk.ReadImage(inputpath)<br>  origin = inputimage.GetOrigin()<br>  spacing = inputimage.GetSpacing()<br>  direction = inputimage.GetDirection()<br>  outputspacing = (spacing[0], spacing[0], spacing[0])<br>  size = inputimage.GetSize()<br>  tmp = int(spacing[2] * size[2] / spacing[0])<br>  if tmp % 2 != 0:<br>    tmp = tmp - 1</p>
<p>  outputsize = (size[0], size[1], tmp)<br>  resamplefilter = sitk.ResampleImageFilter()<br>  resamplefilter.SetOutputDirection(direction)<br>  resamplefilter.SetSize(outputsize)<br>  resamplefilter.SetOutputOrigin(origin)<br>  resamplefilter.SetOutputSpacing(outputspacing)<br>  outputimage = resamplefilter.Execute(inputimage)<br>  numpyImage = sitk.GetArrayFromImage(outputimage)<br>  numpyImage = normalizePlanes(numpyImage)<br>  return numpyImage, list(outputsize), spacing, outputspacing, origin</p>
<p>def createImageBorder(numpyImage, outputsize):<br>  BackImage = np.zeros(((800, 800, 800)))<br>  BackImage[400 - int(outputsize[2] / 2):400 + int(outputsize[2] / 2),<br>            400 - int(outputsize[1] / 2):400 + int(outputsize[1] / 2),<br>            400 - int(outputsize[0] / 2):400 + int(outputsize[0] / 2)] = numpyImage<br>  return BackImage</p>
<p>def readCSV(filename):<br>  ‘’’read lines from a csv file.<br>  ‘’’<br>  lines = []<br>  with open(filename, “rb”) as f:<br>    csvreader = csv.reader(f)<br>    for line in csvreader:<br>      lines.append(line)<br>  return lines</p>
<p>def readSpecialLine(csvLines, uid):<br>  coor = []<br>  label = []<br>  for line in csvLines:<br>    if line[0] == uid:<br>      coor.append(np.array(line[-2:0:-1], np.float))<br>      label.append(int(line[-1]))<br>  return coor, label</p>
<p>def readSpecialLine_own(csvLines, uid):<br>  coor = []<br>  label = []<br>  for line in csvLines:<br>    if line[1] == uid and line[-1] == ‘0’:<br>      coor.append(np.array(line[5:2:-1], np.float))<br>      label.append(int(line[-2]))<br>  return coor, label</p>
<p>Wb = {<br>    ‘W11’: tf.get_variable(‘W11’, [3, 3, 3, FLAGS.CHANNEL_NUMBER, 16], tf.float32, XAVIER_INIT),<br>    ‘b11’: tf.Variable(tf.zeros([16])),<br>    ‘W12’: tf.get_variable(‘W12’, [3, 3, 3, 16, 24], tf.float32, XAVIER_INIT),<br>    ‘b12’: tf.Variable(tf.zeros([24])),<br>    ‘W2’: tf.get_variable(‘W2’, [3, 3, 3, 24, 32], tf.float32, XAVIER_INIT),<br>    ‘b2’: tf.Variable(tf.zeros([32])),<br>    ‘W3’: tf.get_variable(‘W3’, [3, 3, 3, 32, 48], tf.float32, XAVIER_INIT),<br>    ‘b3’: tf.Variable(tf.zeros([48])),<br>    ‘W4’: tf.get_variable(‘W4’, [3, 3, 3, 48, 64], tf.float32, XAVIER_INIT),<br>    ‘b4’: tf.Variable(tf.zeros([64])),<br>    ‘fcw1’: tf.get_variable(‘fcw1’, [2**3 * 64, 32], tf.float32, XAVIER_INIT),<br>    ‘fcb1’: tf.Variable(tf.zeros([32])),<br>    ‘fcw2’: tf.get_variable(‘fcw2’, [32, FLAGS.LABEL_NUMBER], tf.float32, XAVIER_INIT),<br>    ‘fcb2’: tf.Variable(tf.zeros([FLAGS.LABEL_NUMBER]))<br>}</p>
<p>def model(data):<br>  with tf.variable_scope(‘conv1’):<br>    conv = tf.nn.conv3d(data, Wb[‘W11’], strides=[1, 1, 1, 1, 1], padding=’SAME’)<br>    relu = tf.nn.relu(tf.nn.bias_add(conv, Wb[‘b11’]))<br>    conv = tf.nn.conv3d(relu, Wb[‘W12’], strides=[1, 1, 1, 1, 1], padding=’SAME’)<br>    relu = tf.nn.relu(tf.nn.bias_add(conv, Wb[‘b12’]))<br>    pool = tf.nn.max_pool3d(relu, ksize=[1, 2, 2, 2, 1],<br>                            strides=[1, 2, 2, 2, 1], padding=’VALID’)<br>  with tf.variable_scope(‘conv2’):<br>    conv = tf.nn.conv3d(pool, Wb[‘W2’], strides=[1, 1, 1, 1, 1], padding=’SAME’)<br>    relu = tf.nn.relu(tf.nn.bias_add(conv, Wb[‘b2’]))<br>    pool = tf.nn.max_pool3d(relu, ksize=[1, 2, 2, 2, 1],<br>                            strides=[1, 2, 2, 2, 1], padding=’VALID’)<br>  with tf.variable_scope(‘conv3’):<br>    conv = tf.nn.conv3d(pool, Wb[‘W3’], strides=[1, 1, 1, 1, 1], padding=’SAME’)<br>    relu = tf.nn.relu(tf.nn.bias_add(conv, Wb[‘b3’]))<br>    pool = tf.nn.max_pool3d(relu, ksize=[1, 2, 2, 2, 1],<br>                            strides=[1, 2, 2, 2, 1], padding=’VALID’)<br>  with tf.variable_scope(‘conv4’):<br>    conv = tf.nn.conv3d(pool, Wb[‘W4’], strides=[1, 1, 1, 1, 1], padding=’SAME’)<br>    relu = tf.nn.relu(tf.nn.bias_add(conv, Wb[‘b4’]))<br>    pool = tf.nn.max_pool3d(relu, ksize=[1, 2, 2, 2, 1],<br>                            strides=[1, 2, 2, 2, 1], padding=’VALID’)<br>  with tf.variable_scope(‘reshape’):<br>    ps = pool.get_shape().as_list()<br>    reshape = tf.reshape(pool, [-1, ps[1] <em> ps[2] </em> ps[3] * ps[4]])<br>  with tf.variable_scope(‘fc1’):<br>    hidden = tf.nn.relu(tf.matmul(reshape, Wb[‘fcw1’]) + Wb[‘fcb1’])<br>  with tf.variable_scope(‘fc2’):<br>    out = tf.matmul(hidden, Wb[‘fcw2’]) + Wb[‘fcb2’]<br>  return out</p>
<p>def LUNAtest(ssNo, image):<br>  modelPath = ‘/home/kong/4T/official3D_110W/Cross{}’.format(ssNo)<br>  test_data_node = tf.placeholder(<br>      tf.float32, (None, FLAGS.IMAGE_SIZE, FLAGS.IMAGE_SIZE, FLAGS.IMAGE_SIZE, FLAGS.CHANNEL_NUMBER))<br>  test_prediction = tf.nn.softmax(model(test_data_node))</p>
<p>  def test_in_batches(data, sess):<br>    size = data.shape[0]<br>    predictions = np.ndarray(shape=(size, FLAGS.LABEL_NUMBER), dtype=np.float32)<br>    for begin in xrange(0, size, FLAGS.EVAL_BATCH_SIZE):<br>      end = begin + FLAGS.EVAL_BATCH_SIZE<br>      if end &lt;= size:<br>        predictions[begin:end, :] = sess.run(<br>            test_prediction,<br>            feed_dict={test_data_node: data[begin:end, …]})<br>      else:<br>        batch_predictions = sess.run(<br>            test_prediction,<br>            feed_dict={test_data_node: data[-FLAGS.EVAL_BATCH_SIZE:, …]})<br>        predictions[begin:, :] = batch_predictions[begin - size:, :]<br>    return predictions</p>
<p>  saver = tf.train.Saver()<br>  with tf.Session() as sess:<br>    ckpt = tf.train.get_checkpoint_state(modelPath)<br>    ckpt.model_checkpoint_path = os.path.join(modelPath, ckpt.model_checkpoint_path)<br>    if ckpt and ckpt.model_checkpoint_path:<br>      saver.restore(sess, ckpt.model_checkpoint_path)<br>    predictions = test_in_batches(image, sess)<br>  return predictions</p>
<p>def error_rate(preds, labels):<br>  “””Calculate the error rate based on predictions and labels.”””<br>  return 100.0 - (100.0 * np.sum(np.argmax(preds, 1) == labels) / len(preds))</p>
<p>def test_official(mhdOriginalPath, uid, ssNo, csvLines, count):<br>  print(‘Processing No. {}…’.format(count))<br>  axis, label = readSpecialLine(csvLines, uid)<br>  interpolatedImage, outputsize, _, outputspacing, origin = interpolatefilter(<br>      mhdOriginalPath)<br>  BackImage = createImageBorder(interpolatedImage, outputsize)<br>  ccList = []<br>  for a in axis:<br>    cutCenter = worldToVoxelCoord(a, origin[::-1], outputspacing)<br>    cutCenter += (400 - np.array(outputsize[::-1]) / 2)<br>    ccList.append(cutCenter)<br>  ccList = np.round(ccList).astype(np.int)<br>  image = np.empty([len(ccList), FLAGS.SAVE_SIZE, FLAGS.SAVE_SIZE, FLAGS.SAVE_SIZE, 1])<br>  for index, cc in enumerate(ccList):<br>    cutTemp = BackImage[cc[0] - 32:cc[0] + 32,<br>                        cc[1] - 32:cc[1] + 32,<br>                        cc[2] - 32:cc[2] + 32]</p>
<pre><code># saveImageSlice(BackImage, cc, &apos;test1/&apos;)
cutTemp = zoom(cutTemp, float(FLAGS.SAVE\_SIZE) / FLAGS.CUT\_SIZE)
image\[index, :, :, :, 0\] = cutTemp
</code></pre><p>  results = LUNAtest(ssNo, image)<br>  return results, np.array(axis), label</p>
<p>def test_own(mhdOriginalPath, uid, ssNo, csvLines, count):<br>  print(‘Processing No. {}…’.format(count))<br>  axis, label = readSpecialLine_own(csvLines, uid)<br>  interpolatedImage, outputsize, spacing, _, _ = interpolatefilter(mhdOriginalPath)<br>  BackImage = createImageBorder(interpolatedImage, outputsize)<br>  ccList = []<br>  for a in axis:<br>    cutCenter = np.array(a, np.float) * spacing[::-1] / spacing[0]<br>    cutCenter += (400 - np.array(outputsize[::-1]) / 2)<br>    ccList.append(cutCenter)<br>  ccList = np.round(ccList).astype(np.int)<br>  image = np.empty([len(ccList), FLAGS.SAVE_SIZE, FLAGS.SAVE_SIZE, FLAGS.SAVE_SIZE, 1])<br>  for index, cc in enumerate(ccList):<br>    cutTemp = BackImage[cc[0] - 32:cc[0] + 32,<br>                        cc[1] - 32:cc[1] + 32,<br>                        cc[2] - 32:cc[2] + 32]</p>
<pre><code># saveImageSlice(BackImage, cc, &apos;test1/&apos;)
cutTemp = zoom(cutTemp, float(FLAGS.SAVE\_SIZE) / FLAGS.CUT\_SIZE)
image\[index, :, :, :, 0\] = cutTemp
</code></pre><p>  results = LUNAtest(ssNo, image)<br>  return results, np.array(axis), label</p>
<p>def genPath(originalPath):<br>  ‘’’generate a dict with the uid as keys<br>     and the subset number as values.<br>  ‘’’<br>  pathDict = {}<br>  for (dirpath, dirnames, filenames) in walk(originalPath):<br>    dirnames.sort()<br>    filenames.sort()<br>    if(len(filenames) &lt; 20):<br>      continue<br>    else:<br>      for filename in filenames:<br>        if filename.endswith(‘.mhd’):<br>          pathDict.setdefault(filename[:-4], dirpath[-1])<br>  return pathDict</p>
<p>def main(_):<br>  filePath = ‘/home/kong/4T/nodule_project’<br>  pathDict = genPath(filePath)<br>  if FLAGS.USE_OFFICIAL:<br>    csvName = ‘/home/kong/4T/nodule_project/CSVFILES/candidates.csv’<br>    csvLines = readCSV(csvName)[1:]<br>    count = 0<br>    with open(‘results_official.csv’, ‘wb’) as f:<br>      csvwriter = csv.writer(f)<br>      writeContent = [‘seriesuid’, ‘coordX’, ‘coordY’, ‘coordZ’, ‘probability’]<br>      csvwriter.writerow(writeContent)<br>      for uid in pathDict:<br>        ssNo = pathDict[uid]<br>        mhdFileName = (filePath + ‘/subset{}/‘ + ‘{}.mhd’).format(ssNo, uid)<br>        result, axis, label = test_official(mhdFileName, uid, ssNo, csvLines, count)<br>        for index in range(result.shape[0]):<br>          writeContent = [uid, axis[index, 2], axis[<br>              index, 1], axis[index, 0], result[index, 1]]<br>          csvwriter.writerow(writeContent)<br>        count += 1<br>  else:<br>    csvName = ‘/home/kong/4T/new_detect_first/LUNASTable.csv’<br>    csvLines = readCSV(csvName)[1:]<br>    with open(‘results_own.csv’, ‘wb’) as f:<br>      csvwriter = csv.writer(f)<br>      writeContent = [‘seriesuid’, ‘coordX’, ‘coordY’, ‘coordZ’, ‘probability’]<br>      csvwriter.writerow(writeContent)<br>      for uid in pathDict:<br>        ssNo = pathDict[uid]<br>        mhdFileName = (filePath + ‘/subset{}/‘ + ‘{}.mhd’).format(ssNo, uid)<br>        result, axis, label = test_own(mhdFileName, uid, ssNo, csvLines)<br>        for index in range(result.shape[0]):<br>          writeContent = [uid, axis[index, 2], axis[<br>              index, 1], axis[index, 0], result[index, 1]]<br>          csvwriter.writerow(writeContent)</p>
<p>if __name__ == ‘__main__‘:<br>  tf.app.run()</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/12/15/a-tensorflow-example-to-read-data-using-queuerunner/" rel="next" title="a TensorFlow example to read data using QueueRunner">
                <i class="fa fa-chevron-left"></i> a TensorFlow example to read data using QueueRunner
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/12/24/test-the-models-trained-using-3d-cnn/" rel="prev" title="Test the models trained using 3D CNN">
                Test the models trained using 3D CNN <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="John Doe" />
          <p class="site-author-name" itemprop="name">John Doe</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">434</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">categories</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">108</span>
                <span class="site-state-item-name">tags</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
